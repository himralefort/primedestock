<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Destockage Alimentaire | {% block title %}{% endblock %}</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    {% block extra_css %}{% endblock %}
</head>
<style>/* Variables */
    :root {
        --primary-blue: #2563eb;
        --dark-blue: #1e40af;
        --light-blue: #dbeafe;
        --white: #ffffff;
        --gray-light: #f3f4f6;
        --gray-medium: #9ca3af;
        --gray-dark: #4b5563;
        --shadow-sm: 0 1px 3px rgba(0,0,0,0.12);
        --shadow-md: 0 4px 6px rgba(0,0,0,0.16);
        --shadow-lg: 0 10px 25px rgba(0,0,0,0.1);
    }
    
    /* Animations */
    @keyframes popIn {
        0% { opacity: 0; transform: scale(0.8); }
        100% { opacity: 1; transform: scale(1); }
    }
    
    @keyframes float {
        0% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
        100% { transform: translateY(0); }
    }
    
    .animate-pop-in {
        animation: popIn 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }
    
    .animate-float {
        animation: float 4s ease-in-out infinite;
    }
    
    .animate-float-delay {
        animation: float 4s ease-in-out 0.5s infinite;
    }
    
    /* Hero Animé */
    .animated-hero {
        position: relative;
        height: 80vh;
        min-height: 600px;
        display: flex;
        align-items: center;
        overflow: hidden;
    }
    
    .hero-background {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-size: cover;
        background-position: center;
        z-index: 1;
        transform: scale(1);
        transition: transform 8s ease;
    }
    
    .animated-hero:hover .hero-background {
        transform: scale(1.05);
    }
    
    .hero-content {
        position: relative;
        z-index: 3;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem;
        color: var(--white);
        text-align: center;
    }
    
    .hero-title {
        font-size: 4rem;
        font-weight: 800;
        margin-bottom: 1.5rem;
        text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        opacity: 0;
        animation-delay: 0.2s;
    }
    
    .hero-subtitle {
        font-size: 1.8rem;
        max-width: 700px;
        margin: 0 auto 3rem;
        text-shadow: 0 1px 5px rgba(0,0,0,0.2);
        opacity: 0;
        animation-delay: 0.4s;
    }
    
    .hero-btn {
        display: inline-block;
        background: var(--white);
        color: var(--primary-blue);
        padding: 1rem 2.5rem;
        font-size: 1.2rem;
        font-weight: 600;
        border-radius: 50px;
        text-decoration: none;
        box-shadow: var(--shadow-lg);
        transition: all 0.3s ease;
        opacity: 0;
        animation-delay: 0.6s;
    }
    
    .hero-btn:hover {
        background: var(--light-blue);
        transform: translateY(-3px);
        box-shadow: 0 15px 30px rgba(0,0,0,0.2);
    }
    
    /* Barre de recherche */
    .search-section {
        padding: 2rem 0;
        background: var(--white);
        position: relative;
        z-index: 10;
        margin-top: -50px;
    }
    
    .modern-search-form {
        max-width: 800px;
        margin: 0 auto;
        display: flex;
        border-radius: 50px;
        overflow: hidden;
        box-shadow: var(--shadow-lg);
    }
    
    .search-input {
        flex: 1;
        padding: 1.2rem 2rem;
        border: none;
        font-size: 1.1rem;
        outline: none;
    }
    
    .search-input:focus {
        background: var(--light-blue);
    }
    
    .search-btn {
        background: var(--primary-blue);
        color: var(--white);
        border: none;
        padding: 0 2.5rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .search-btn:hover {
        background: var(--dark-blue);
    }
    
    /* Section À propos */
    .modern-about {
        padding: 5rem 0;
        background: var(--gray-light);
    }
    
    .about-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
    }
    
    .about-card {
        background: var(--white);
        border-radius: 20px;
        padding: 2.5rem;
        box-shadow: var(--shadow-sm);
        transition: all 0.3s ease;
        text-align: center;
    }
    
    .about-card:hover {
        transform: translateY(-10px);
        box-shadow: var(--shadow-lg);
    }
    
    .about-icon {
        font-size: 3rem;
        margin-bottom: 1.5rem;
        color: var(--primary-blue);
    }
    
    .about-card h3 {
        font-size: 1.5rem;
        margin-bottom: 1rem;
        color: var(--gray-dark);
    }
    
    .about-card p {
        color: var(--gray-medium);
        margin-bottom: 1.5rem;
    }
    
    .badges {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin-top: 1.5rem;
    }
    
    .badges img {
        height: 60px;
        width: auto;
    }
    
    .about-links {
        list-style: none;
        text-align: left;
    }
    
    .about-links li {
        margin-bottom: 0.8rem;
    }
    
    .about-links a {
        color: var(--gray-dark);
        text-decoration: none;
        transition: all 0.3s;
        display: block;
        padding: 0.5rem 0;
    }
    
    .about-links a:hover {
        color: var(--primary-blue);
        padding-left: 10px;
    }
    
    .contact-info p {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.8rem;
        margin-bottom: 1rem;
    }
    
    .social-icons {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin-top: 1.5rem;
    }
    
    .social-icons a {
        color: var(--primary-blue);
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: var(--light-blue);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s;
    }
    
    .social-icons a:hover {
        background: var(--primary-blue);
        color: var(--white);
        transform: translateY(-3px);
    }
    
    /* Footer */
    .modern-footer {
        background: var(--gray-dark);
        color: var(--white);
        padding: 2rem 0;
        text-align: center;
    }
    
    .copyright {
        opacity: 0.8;
        font-size: 0.9rem;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
        .hero-title {
            font-size: 2.5rem;
        }
        
        .hero-subtitle {
            font-size: 1.2rem;
        }
        
        .modern-search-form {
            flex-direction: column;
            border-radius: 15px;
        }
        
        .search-input {
            border-radius: 15px 15px 0 0;
        }
        
        .search-btn {
            border-radius: 0 0 15px 15px;
            padding: 1rem;
        }
    }
    .btn-checkout {
    /* Style de base */
    display: inline-block;
    width: 100%;
    padding: 15px 25px;
    margin-top: 20px;
    
    /* Couleurs */
    background-color: #2a5bd7;
    color: white;
    border: none;
    border-radius: 8px;
    
    /* Texte */
    font-size: 18px;
    font-weight: 600;
    text-align: center;
    text-decoration: none;
    
    /* Effets */
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    
    /* Alignement */
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }

  /* Icone (optionnel) */
  .btn-checkout::before {
    content: "→";
    font-size: 20px;
  }

  /* Effet au survol */
  .btn-checkout:hover {
    background-color: #1e4aba;
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
  }

  /* Effet quand on clique */
  .btn-checkout:active {
    transform: translateY(1px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  /* Style quand le panier est vide */
  .btn-checkout:disabled {
    background-color: #cccccc;
    cursor: not-allowed;
    opacity: 0.7;
  }

  /* Version mobile */
  @media (max-width: 768px) {
    .btn-checkout {
      padding: 12px 20px;
      font-size: 16px;
    }
  }
    </style>
<body>
    <!-- Navbar bleue -->
    <nav class="navbar" style="background-color: #2a5bd7; color: white;">
        <div class="container">
            <a href="{{ url_for('index') }}" class="logo">
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo Destockage Alimentaire">
                <h1 style="color: white;">Destockage Alimentaire</h1>
            </a>
            
            <div class="nav-links">
                <a href="{{ url_for('index') }}" style="color: white;">Accueil</a>
                <a href="{{ url_for('product_list') }}" style="color: white;">Produits</a>
                <a href="{{ url_for('view_cart') }}" style="color: white;">Panier</a>
                <a href="{{ url_for('contact') }}" style="color: white;">Contact</a>
                
                {% if session.logged_in %}
                    <a href="{{ url_for('account') }}" style="color: white;">Mon Compte</a>
                    <a href="{{ url_for('logout') }}" style="color: white;">Déconnexion</a>
                {% else %}
                    <a href="{{ url_for('login') }}" style="color: white;">Connexion</a>
                    <a href="{{ url_for('register') }}" style="color: white; background-color: #1e4aba; padding: 8px 20px; border-radius: 50px;">Inscription</a>
                {% endif %}
            </div>
            
            <div class="cart-icon" id="cart-icon" style="color: white;">
                <i class="fas fa-shopping-cart"></i>
                <span class="cart-count" id="cart-count">
                    {% if 'cart' in session %}
                        {{ session.cart.values()|sum }}
                    {% else %}
                        0
                    {% endif %}
                </span>
            </div>
            
            <button class="mobile-menu-btn" id="mobile-menu-btn">
                <i class="fas fa-bars" style="color: white;"></i>
            </button>
        </div>
    </nav>

    <!-- Mobile Menu bleu -->
    <div class="mobile-menu" id="mobile-menu" style="background-color: #2a5bd7;">
        <div class="mobile-menu-header">
            <button class="close-mobile-menu" id="close-mobile-menu">
                <i class="fas fa-times" style="color: white;"></i>
            </button>
        </div>
        <div class="mobile-menu-links">
            <a href="{{ url_for('index') }}" style="color: white;">Accueil</a>
            <a href="{{ url_for('product_list') }}" style="color: white;">Produits</a>
            <a href="{{ url_for('view_cart') }}" style="color: white;">Panier</a>
            <a href="{{ url_for('contact') }}" style="color: white;">Contact</a>
            
            {% if session.logged_in %}
                <a href="{{ url_for('account') }}" style="color: white;">Mon Compte</a>
                <a href="{{ url_for('logout') }}" style="color: white;">Déconnexion</a>
            {% else %}
                <a href="{{ url_for('login') }}" style="color: white;">Connexion</a>
                <a href="{{ url_for('register') }}" style="color: white;">Inscription</a>
            {% endif %}
        </div>
    </div>

    <!-- Contenu principal -->
    <main>
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="flash-messages">
                    {% for category, message in messages %}
                        <div class="flash flash-{{ category }}">
                            {{ message }}
                            <button class="close-flash">&times;</button>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}
        
        {% block content %}{% endblock %}
    </main>

    <!-- Footer bleu -->
<footer class="modern-footer">
    <div class="footer-container">
        <!-- Première ligne : Contenu principal -->
        <div class="footer-grid">
            <!-- Colonne A propos -->
            <div class="footer-col">
                <h3 class="footer-title">À propos</h3>
                <div class="footer-logo">
                    <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo Destockage Alimentaire" class="logo-hover-transform">
                    <span class="logo-text-gradient">Destockage Alimentaire</span>
                </div>
                <p class="footer-text">Spécialisé dans la vente de produits alimentaires de qualité à prix réduits.</p>
                
                <div class="certification-badges">
                    <div class="badge pulse-animation">
                        <i class="fas fa-certificate"></i>
                        <span>Certification qualité</span>
                    </div>
                    <div class="badge pulse-animation">
                        <i class="fas fa-lock"></i>
                        <span>Paiement sécurisé</span>
                    </div>
                </div>
            </div>

            <!-- Colonne Liens utiles -->
            <div class="footer-col">
                <h3 class="footer-title">Liens utiles</h3>
                <ul class="footer-links">
                    <li><a href="/mentions-legales" class="link-hover-effect">Mentions légales</a></li>
                    <li><a href="/cgv" class="link-hover-effect">CGV</a></li>
                    <li><a href="/politique-confidentialite" class="link-hover-effect">Politique de confidentialité</a></li>
                    <li><a href="/faq" class="link-hover-effect">FAQ</a></li>
                </ul>
                
                
            </div>

            <!-- Colonne Contact -->
            <div class="footer-col">
                <h3 class="footer-title">Contact</h3>
                <div class="contact-info">
                    <div class="contact-item floating-effect">
                        <i class="fas fa-phone icon-scale"></i>
                        <span>01 23 45 67 89</span>
                    </div>
                    <div class="contact-item floating-effect">
                        <i class="fas fa-envelope icon-scale"></i>
                        <span>contact@destockage-alimentaire.com</span>
                    </div>
                </div>
                
                <div class="social-links">
                    <a href="#" class="social-icon-3d"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="social-icon-3d"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="social-icon-3d"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="social-icon-3d"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>

            <!-- Colonne Newsletter -->
            <div class="footer-col">
                <h3 class="footer-title">Newsletter</h3>
                <p class="footer-text">Abonnez-vous pour recevoir nos offres exclusives</p>
                <form class="newsletter-form">
                    <input type="email" placeholder="Votre email" required class="input-glow">
                    <button type="submit" class="submit-btn-3d">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </form>
                <div class="newsletter-confetti hidden" id="newsletter-confetti"></div>
            </div>
        </div>

        <!-- Deuxième ligne : Copyright -->
        <div class="footer-bottom">
            <div class="copyright">
                © 2024 Destockage Alimentaire. Tous droits réservés.
            </div>
            <div class="legal-links">
                <a href="/mentions-legales" class="link-hover-effect">Mentions légales</a>                <span class="separator-dot">•</span>
                <a href="/politique-confidentialite" class="link-hover-effect">Politique de confidentialité</a>
            </div>
        </div>
    </div>
</footer>

<style>
    /* Styles modernes pour le footer */
    .modern-footer {
        background-color: #2a5bd7;
        color: white;
        padding: 60px 0 30px;
        position: relative;
        font-family: 'Inter', sans-serif;
        overflow: hidden;
    }

    .modern-footer::before {
        content: '';
        position: absolute;
        top: -50px;
        left: 0;
        width: 100%;
        height: 50px;
        background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 320'%3E%3Cpath fill='%23ffffff' fill-opacity='1' d='M0,192L48,197.3C96,203,192,213,288,229.3C384,245,480,267,576,250.7C672,235,768,181,864,181.3C960,181,1056,235,1152,234.7C1248,235,1344,181,1392,154.7L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z'%3E%3C/path%3E%3C/svg%3E");
        background-size: cover;
    }

    .modern-footer::after {
        content: '';
        position: absolute;
        bottom: 0;
        right: 0;
        width: 300px;
        height: 300px;
        background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
        z-index: 0;
    }

    .footer-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
        position: relative;
        z-index: 1;
    }

    .footer-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 40px;
        margin-bottom: 40px;
    }

    .footer-col {
        padding: 0 15px;
        position: relative;
        z-index: 1;
    }

    .footer-title {
        font-size: 1.3rem;
        margin-bottom: 25px;
        position: relative;
        padding-bottom: 15px;
        font-weight: 600;
    }

    .footer-title::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 50px;
        height: 3px;
        background: rgba(255,255,255,0.5);
        transition: width 0.5s ease;
    }

    .footer-col:hover .footer-title::after {
        width: 80px;
    }

    .footer-logo {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 20px;
    }

    .footer-logo img {
        height: 30px;
        width: auto;
        transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .logo-hover-transform:hover {
        transform: rotate(15deg) scale(1.1);
    }

    .logo-text-gradient {
        font-weight: 600;
        font-size: 1.1rem;
        background: linear-gradient(90deg, #ffffff, #dbeafe);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
    }

    .footer-text {
        color: rgba(255,255,255,0.8);
        margin-bottom: 20px;
        line-height: 1.6;
        font-size: 0.95rem;
    }

    .certification-badges {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-top: 20px;
    }

    .badge {
        display: flex;
        align-items: center;
        gap: 10px;
        background: rgba(255,255,255,0.1);
        padding: 8px 15px;
        border-radius: 50px;
        font-size: 0.85rem;
        width: fit-content;
        transition: all 0.3s ease;
        backdrop-filter: blur(5px);
        border: 1px solid rgba(255,255,255,0.2);
    }

    .badge:hover {
        background: rgba(255,255,255,0.2);
        transform: translateY(-3px);
    }

    .badge i {
        color: #4CAF50;
    }

    .pulse-animation {
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }

    .footer-links {
        list-style: none;
    }

    .footer-links li {
        margin-bottom: 12px;
        position: relative;
    }

    .footer-links a {
        color: rgba(255,255,255,0.8);
        text-decoration: none;
        transition: all 0.3s;
        font-size: 0.95rem;
        display: inline-block;
        position: relative;
    }

    .link-hover-effect::after {
        content: '';
        position: absolute;
        bottom: -2px;
        left: 0;
        width: 0;
        height: 2px;
        background: white;
        transition: width 0.3s ease;
    }

    .link-hover-effect:hover::after {
        width: 100%;
    }

    .link-hover-effect:hover {
        color: white;
        transform: translateX(5px);
    }

    .contact-info {
        display: flex;
        flex-direction: column;
        gap: 15px;
        margin-bottom: 25px;
    }

    .contact-item {
        display: flex;
        align-items: center;
        gap: 10px;
        color: rgba(255,255,255,0.8);
        font-size: 0.95rem;
        transition: all 0.3s ease;
    }

    .floating-effect:hover {
        transform: translateY(-3px);
    }

    .icon-scale {
        transition: transform 0.3s ease;
    }

    .contact-item:hover .icon-scale {
        transform: scale(1.2);
    }

    .social-links {
        display: flex;
        gap: 15px;
    }

    .social-icon-3d {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: rgba(255,255,255,0.1);
        color: white;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .social-icon-3d::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: 0.5s;
    }

    .social-icon-3d:hover::before {
        left: 100%;
    }

    .social-icon-3d:hover {
        background: rgba(255,255,255,0.2);
        transform: translateY(-5px) scale(1.1);
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    .newsletter-form {
        display: flex;
        margin-top: 15px;
        position: relative;
    }

    .input-glow {
        flex: 1;
        padding: 12px 15px;
        border: none;
        border-radius: 30px 0 0 30px;
        font-size: 0.9rem;
        outline: none;
        transition: all 0.3s ease;
        background: rgba(255,255,255,0.9);
    }

    .input-glow:focus {
        box-shadow: 0 0 10px rgba(255,255,255,0.5);
    }

    .submit-btn-3d {
        background: white;
        color: #2a5bd7;
        border: none;
        width: 45px;
        border-radius: 0 30px 30px 0;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .submit-btn-3d:hover {
        background: #f5f5f5;
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    .submit-btn-3d:active {
        transform: translateY(0);
    }

    .newsletter-confetti {
        position: absolute;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 10;
    }

    .footer-bottom {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-top: 30px;
        border-top: 1px solid rgba(255,255,255,0.1);
        font-size: 0.85rem;
        color: rgba(255,255,255,0.6);
        flex-wrap: wrap;
        gap: 15px;
    }

    .legal-links {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .separator-dot {
        opacity: 0.6;
    }

    .legal-links a {
        color: rgba(255,255,255,0.6);
        text-decoration: none;
        transition: all 0.3s;
    }

    .legal-links a:hover {
        color: white;
    }

    /* Animation de fond */
    .modern-footer {
        background: linear-gradient(135deg, #2a5bd7 0%, #1e4aba 100%);
    }

    /* Effets de particules */
    .particle {
        position: absolute;
        background: rgba(255,255,255,0.3);
        border-radius: 50%;
        pointer-events: none;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .footer-grid {
            grid-template-columns: 1fr 1fr;
        }
        
        .footer-bottom {
            flex-direction: column;
            text-align: center;
        }

        .footer-title::after {
            width: 30px;
        }

        .footer-col:hover .footer-title::after {
            width: 40px;
        }
    }

    @media (max-width: 480px) {
        .footer-grid {
            grid-template-columns: 1fr;
        }
    }
</style>

<script>
    // Animation des particules
    document.addEventListener('DOMContentLoaded', function() {
        const footer = document.querySelector('.modern-footer');
        
        // Créer des particules
        for (let i = 0; i < 20; i++) {
            createParticle(footer);
        }
        
        // Animation du formulaire newsletter
        const newsletterForm = document.querySelector('.newsletter-form');
        if (newsletterForm) {
            newsletterForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const confetti = document.getElementById('newsletter-confetti');
                confetti.classList.remove('hidden');
                
                // Créer des confettis
                for (let i = 0; i < 30; i++) {
                    createConfetti(confetti);
                }
                
                setTimeout(() => {
                    confetti.innerHTML = '';
                    confetti.classList.add('hidden');
                }, 3000);
            });
        }
    });
    
    function createParticle(container) {
        const particle = document.createElement('div');
        particle.classList.add('particle');
        
        const size = Math.random() * 5 + 1;
        const posX = Math.random() * container.offsetWidth;
        const posY = Math.random() * container.offsetHeight;
        const duration = Math.random() * 20 + 10;
        const delay = Math.random() * 5;
        
        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;
        particle.style.left = `${posX}px`;
        particle.style.top = `${posY}px`;
        particle.style.opacity = Math.random() * 0.5 + 0.1;
        particle.style.animation = `float ${duration}s ease-in-out ${delay}s infinite`;
        
        container.appendChild(particle);
    }
    
    function createConfetti(container) {
        const confetti = document.createElement('div');
        confetti.classList.add('confetti');
        
        const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
        const color = colors[Math.floor(Math.random() * colors.length)];
        
        const size = Math.random() * 10 + 5;
        const posX = Math.random() * 100;
        const duration = Math.random() * 3 + 2;
        const delay = Math.random() * 2;
        
        confetti.style.backgroundColor = color;
        confetti.style.width = `${size}px`;
        confetti.style.height = `${size}px`;
        confetti.style.left = `${posX}%`;
        confetti.style.animation = `confetti-fall ${duration}s ease-in ${delay}s forwards`;
        
        container.appendChild(confetti);
    }
</script>
    
    <style>
        /* Styles modernes pour le footer */
        .modern-footer {
            background-color: #2a5bd7;
            color: white;
            padding: 60px 0 30px;
            position: relative;
            font-family: 'Inter', sans-serif;
        }
    
        .modern-footer::before {
            content: '';
            position: absolute;
            top: -50px;
            left: 0;
            width: 100%;
            height: 50px;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 320'%3E%3Cpath fill='%23ffffff' fill-opacity='1' d='M0,192L48,197.3C96,203,192,213,288,229.3C384,245,480,267,576,250.7C672,235,768,181,864,181.3C960,181,1056,235,1152,234.7C1248,235,1344,181,1392,154.7L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z'%3E%3C/path%3E%3C/svg%3E");
            background-size: cover;
        }
    
        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
    
        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }
    
        .footer-col {
            padding: 0 15px;
        }
    
        .footer-title {
            font-size: 1.3rem;
            margin-bottom: 25px;
            position: relative;
            padding-bottom: 15px;
            font-weight: 600;
        }
    
        .footer-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 50px;
            height: 3px;
            background: rgba(255,255,255,0.5);
        }
    
        .footer-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }
    
        .footer-logo img {
            height: 30px;
            width: auto;
        }
    
        .footer-logo span {
            font-weight: 600;
            font-size: 1.1rem;
        }
    
        .footer-text {
            color: rgba(255,255,255,0.8);
            margin-bottom: 20px;
            line-height: 1.6;
            font-size: 0.95rem;
        }
    
        .certification-badges {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }
    
        .badge {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255,255,255,0.1);
            padding: 8px 15px;
            border-radius: 50px;
            font-size: 0.85rem;
            width: fit-content;
        }
    
        .badge i {
            color: #4CAF50;
        }
    
        .footer-links {
            list-style: none;
        }
    
        .footer-links li {
            margin-bottom: 12px;
        }
    
        .footer-links a {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            transition: all 0.3s;
            font-size: 0.95rem;
            display: inline-block;
        }
    
        .footer-links a:hover {
            color: white;
            transform: translateX(5px);
        }
    
        .contact-info {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 25px;
        }
    
        .contact-item {
            display: flex;
            align-items: center;
            gap: 10px;
            color: rgba(255,255,255,0.8);
            font-size: 0.95rem;
        }
    
        .contact-item i {
            width: 20px;
            text-align: center;
        }
    
        .social-links {
            display: flex;
            gap: 15px;
        }
    
        .social-links a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            color: white;
            transition: all 0.3s;
        }
    
        .social-links a:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-3px);
        }
    
        .newsletter-form {
            display: flex;
            margin-top: 15px;
        }
    
        .newsletter-form input {
            flex: 1;
            padding: 12px 15px;
            border: none;
            border-radius: 30px 0 0 30px;
            font-size: 0.9rem;
            outline: none;
        }
    
        .newsletter-form button {
            background: white;
            color: #2a5bd7;
            border: none;
            width: 45px;
            border-radius: 0 30px 30px 0;
            cursor: pointer;
            transition: all 0.3s;
        }
    
        .newsletter-form button:hover {
            background: #f5f5f5;
        }
    
        .footer-bottom {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255,255,255,0.1);
            font-size: 0.85rem;
            color: rgba(255,255,255,0.6);
            flex-wrap: wrap;
            gap: 15px;
        }
    
        .legal-links {
            display: flex;
            align-items: center;
            gap: 10px;
        }
    
        .legal-links a {
            color: rgba(255,255,255,0.6);
            text-decoration: none;
            transition: all 0.3s;
        }
    
        .legal-links a:hover {
            color: white;
        }
    
        @media (max-width: 768px) {
            .footer-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .footer-bottom {
                flex-direction: column;
                text-align: center;
            }
        }
    
        @media (max-width: 480px) {
            .footer-grid {
                grid-template-columns: 1fr;
            }
        }
        /* Ajoutez ceci à votre CSS */
.cart-popup {
    position: fixed;
    top: 0;
    right: -400px;
    width: 400px;
    height: 100vh;
    background: white;
    box-shadow: -5px 0 15px rgba(0,0,0,0.1);
    z-index: 1000;
    transition: right 0.3s ease;
    overflow-y: auto;
}

.cart-popup.active {
    right: 0;
}

.overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    z-index: 999;
    display: none;
}

.overlay.active {
    display: block;
}

.no-scroll {
    overflow: hidden;
}
</style>

</body>
</html>
    <!-- Cart Popup -->
    <div class="cart-popup" id="cart-popup">
        <div class="cart-header">
            <h3>Votre Panier</h3>
            <button class="close-cart" id="close-cart"><i class="fas fa-times"></i></button>
        </div>
        
        <div class="cart-items" id="cart-items">
            {% if 'cart' not in session or not session.cart %}
                <div class="empty-cart">
                    <p>Votre panier est vide</p>
                    <a href="{{ url_for('product_list') }}" class="btn">Voir nos produits</a>
                </div>
            {% else %}
                {% for product_id, quantity in session.cart.items() %}
                    {% set product = products|selectattr('id', 'equalto', product_id|int)|first %}
                    {% if product %}
                        <div class="cart-item">
                            <div class="cart-item-image">
                                <img src="{{ url_for('static', filename='images/products/' + product.images[0]) }}">
                            </div>
                            <div class="cart-item-details">
                                <h4 class="cart-item-title">{{ product.name }}</h4>
                                <div class="cart-item-price">{{ "%.2f"|format(product.price) }}€</div>
                                <div class="cart-item-actions">
                                    <button type="button" class="quantity-btn minus" data-id="{{ product_id }}">-</button>
                                    <input type="number" class="quantity-input" value="{{ quantity }}" min="1" data-id="{{ product_id }}">
                                    <button type="button" class="quantity-btn plus" data-id="{{ product_id }}">+</button>
                                    <button type="button" class="remove-item" data-id="{{ product_id }}">Supprimer</button>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            {% endif %}
        </div>
        
        {% if 'cart' in session and session.cart %}
        <div class="cart-totals">
            <div class="cart-total-row">
                <span>Sous-total</span>
                <span id="cart-subtotal">
                    {% set subtotal = namespace(value=0) %}
                    {% for product_id, quantity in session.cart.items() %}
                        {% set product = products|selectattr('id', 'equalto', product_id|int)|first %}
                        {% if product %}
                            {% set subtotal.value = subtotal.value + (product.price * quantity) %}
                        {% endif %}
                    {% endfor %}
                    {{ "%.2f"|format(subtotal.value) }}€
                </span>
            </div>
            <div class="cart-total-row">
                <span>Livraison</span>
                <span>Calculé à l'étape suivante</span>
            </div>
            <div class="cart-total-row total">
                <span>Total</span>
                <span id="cart-total">{{ "%.2f"|format(subtotal.value) }}€</span>
            </div>
        </div>
            
        <a href="{{ url_for('checkout' if session.logged_in or session.guest else 'checkout_auth') }}" 
        class="btn-checkout">
         Passer commande
         </a>     
    {% endif %}
    </div>
    
    <div class="overlay" id="overlay"></div>

    <!-- Chatbot -->
    <div class="chatbot">
        <button class="chatbot-btn" id="chatbot-btn">
            <i class="fas fa-comment-dots"></i>
        </button>
        <div class="chatbot-container" id="chatbot-container">
            <div class="chatbot-header">
                <h3>Assistant Virtuel</h3>
                <button class="close-chatbot" id="close-chatbot"><i class="fas fa-times"></i></button>
            </div>
            <div class="chatbot-messages" id="chatbot-messages">
                <div class="message bot-message">
                    Bonjour ! Comment puis-je vous aider aujourd'hui ?
                </div>
            </div>
            <div class="chatbot-input">
                <input type="text" id="chatbot-input" placeholder="Tapez votre message...">
                <button id="send-message"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    <script>
        // Variables globales pour gérer l'état du panier
        let cartEventListenersAttached = false;
    
        document.addEventListener('DOMContentLoaded', function() {
            // Gestion de l'ouverture/fermeture du popup
            const cartIcon = document.getElementById('cart-icon');
            const cartPopup = document.getElementById('cart-popup');
            const closeCart = document.getElementById('close-cart');
            const overlay = document.getElementById('overlay');
    
            cartIcon?.addEventListener('click', function(e) {
                e.preventDefault();
                cartPopup.classList.add('active');
                overlay.classList.add('active');
                document.body.classList.add('no-scroll');
                updateCartPopup();
            });
    
            closeCart?.addEventListener('click', closeCartPopup);
            overlay?.addEventListener('click', closeCartPopup);
    
            function closeCartPopup() {
                cartPopup.classList.remove('active');
                overlay.classList.remove('active');
                document.body.classList.remove('no-scroll');
            }
    
            // Délégation d'événements pour tout le panier
            document.addEventListener('click', function(e) {
                if (!e.target.closest('#cart-popup')) return;
    
                const target = e.target;
                const itemElement = target.closest('.cart-item');
                if (!itemElement) return;
    
                const productId = itemElement.dataset.id;
                const input = itemElement.querySelector('.quantity-input');
    
                // Gestion des boutons quantité
                if (target.classList.contains('quantity-btn')) {
                    e.preventDefault();
                    let quantity = parseInt(input.value);
    
                    if (target.classList.contains('minus')) {
                        quantity = Math.max(1, quantity - 1);
                    } else {
                        quantity += 1;
                    }
    
                    input.value = quantity;
                    updateCartItem(productId, quantity);
                    return;
                }
    
                // Gestion de la suppression
                if (target.classList.contains('remove-item')) {
                    e.preventDefault();
                    if (confirm('Voulez-vous vraiment supprimer cet article ?')) {
                        removeCartItem(productId);
                    }
                    return;
                }
            });
    
            // Gestion des changements manuels de quantité
            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('quantity-input')) {
                    const itemElement = e.target.closest('.cart-item');
                    const productId = itemElement.dataset.id;
                    let quantity = parseInt(e.target.value);
    
                    if (isNaN(quantity) || quantity < 1) {
                        quantity = 1;
                        e.target.value = quantity;
                    }
    
                    updateCartItem(productId, quantity);
                }
            });
    
            updateCartCount();
        });
    
        // Fonctions utilitaires
        async function updateCartPopup() {
            try {
                const response = await fetch('/api/cart/items');
                const items = await response.json();
                const cartItemsContainer = document.getElementById('cart-items');
                const cartTotals = document.querySelector('.cart-totals');
    
                if (items.length === 0) {
                    cartItemsContainer.innerHTML = `
                        <div class="empty-cart">
                            <p>Votre panier est vide</p>
                            <a href="{{ url_for('product_list') }}" class="btn">Voir nos produits</a>
                        </div>`;
                    cartTotals.style.display = 'none';
                    return;
                }
    
                let html = '';
                let subtotal = 0;
    
                items.forEach(item => {
                    subtotal += item.total;
                    html += `
                        <div class="cart-item" data-id="${item.id}">
                            <div class="cart-item-image">
                                <img src="/static/images/products/${item.image}" alt="${item.name}">
                            </div>
                            <div class="cart-item-details">
                                <h4 class="cart-item-title">${item.name}</h4>
                                <div class="cart-item-price">${item.price.toFixed(2)}€</div>
                                <div class="cart-item-actions">
                                    <button class="quantity-btn minus" data-id="${item.id}">-</button>
                                    <input type="number" class="quantity-input" value="${item.quantity}" min="1" data-id="${item.id}">
                                    <button class="quantity-btn plus" data-id="${item.id}">+</button>
                                    <button class="remove-item" data-id="${item.id}">Supprimer</button>
                                </div>
                            </div>
                            <div class="cart-item-total">${item.total.toFixed(2)}€</div>
                        </div>`;
                });
    
                cartItemsContainer.innerHTML = html;
                document.getElementById('cart-subtotal').textContent = subtotal.toFixed(2) + '€';
                document.getElementById('cart-total').textContent = subtotal.toFixed(2) + '€';
                cartTotals.style.display = 'block';
    
            } catch (error) {
                console.error('Erreur lors de la mise à jour du panier:', error);
            }
        }
    
        async function updateCartItem(productId, quantity) {
            try {
                const response = await fetch('/modifier-panier', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    body: JSON.stringify({ product_id: productId, quantity: quantity })
                });
                const data = await response.json();
                
                if (data.success) {
                    updateCartCount(data.cart_count);
                    // Mise à jour visuelle immédiate
                    const itemElement = document.querySelector(`.cart-item[data-id="${productId}"]`);
                    if (itemElement) {
                        const totalElement = itemElement.querySelector('.cart-item-total');
                        const price = parseFloat(itemElement.querySelector('.cart-item-price').textContent);
                        totalElement.textContent = (price * quantity).toFixed(2) + '€';
                    }
                }
            } catch (error) {
                console.error('Erreur lors de la mise à jour de l\'article:', error);
            }
        }
    
        async function removeCartItem(productId) {
            try {
                const response = await fetch(`/supprimer-du-panier/${productId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                });
                const data = await response.json();
                
                if (data.success) {
                    updateCartPopup();
                    updateCartCount(data.cart_count);
                }
            } catch (error) {
                console.error('Erreur lors de la suppression de l\'article:', error);
            }
        }
    
        async function updateCartCount(count) {
            if (count !== undefined) {
                document.getElementById('cart-count').textContent = count;
                return;
            }
            
            try {
                const response = await fetch('/api/cart/count');
                const data = await response.json();
                document.getElementById('cart-count').textContent = data.count;
            } catch (error) {
                console.error('Erreur lors de la mise à jour du compteur:', error);
            }
        }
        // Dans votre fichier JavaScript principal
document.addEventListener('DOMContentLoaded', function() {
  const checkoutBtn = document.querySelector('.cart-popup .btn-checkout');
  
  if (checkoutBtn) {
    checkoutBtn.addEventListener('click', function(e) {
      e.preventDefault();
      
      // Vérification côté client que le panier n'est pas vide
      const cartItemsCount = parseInt(document.querySelector('.cart-count').textContent) || 0;
      
      if (cartItemsCount === 0) {
        alert('Votre panier est vide, veuillez ajouter des articles');
        return;
      }
      
      // Redirection vers la page d'authentification
      window.location.href = this.getAttribute('data-checkout-url') || '/checkout_auth';
    });
  }
});
function updateCartItem(productId, quantity) {
    fetch('/modifier-panier', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-Requested-With': 'XMLHttpRequest'
        },
        body: JSON.stringify({
            product_id: productId,
            quantity: quantity
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // Mise à jour des totaux dans le popup
            const itemElement = document.querySelector(`.cart-item[data-id="${productId}"]`);
            if (itemElement) {
                const price = parseFloat(itemElement.querySelector('.cart-item-price').textContent);
                const totalElement = itemElement.querySelector('.cart-item-total');
                totalElement.textContent = (price * quantity).toFixed(2) + '€';
            }
            
            // Mise à jour des totaux globaux
            updateCartTotals();
            updateCartCount(data.cart_count);
        }
    });
}

function updateCartTotals() {
    let subtotal = 0;
    
    document.querySelectorAll('.cart-item').forEach(item => {
        const price = parseFloat(item.querySelector('.cart-item-price').textContent);
        const quantity = parseInt(item.querySelector('.quantity-input').value);
        subtotal += price * quantity;
    });

    // Mise à jour dans le popup
    document.getElementById('cart-subtotal').textContent = subtotal.toFixed(2) + '€';
    document.getElementById('cart-total').textContent = subtotal.toFixed(2) + '€';
    
    // Mise à jour dans la page panier si on y est
    const pageSubtotal = document.querySelector('.cart-summary #cart-subtotal');
    const pageTotal = document.querySelector('.cart-summary #cart-total');
    if (pageSubtotal && pageTotal) {
        pageSubtotal.textContent = subtotal.toFixed(2) + '€';
        pageTotal.textContent = subtotal.toFixed(2) + '€';
    }
}
// Dans votre script principal
document.querySelectorAll('.btn-checkout').forEach(btn => {
    btn.addEventListener('click', function(e) {
        if (!{{ 'true' if session.logged_in or session.guest else 'false' }}) {
            e.preventDefault();
            window.location.href = "{{ url_for('checkout_auth') }}";
        }
    });
});

    </script>
    <script type="application/ld+json">
        {
          "@context": "https://schema.org",
          "@type": "Store",
          "name": "Destockage Alimentaire Prénium",
          "description": "Leader du destockage alimentaire en France. Produits jusqu'à -70% : boissons, surgelés, épicerie.",
          "url": "https://www.destockage-alimentaire.com",
          "logo": "https://www.destockage-alimentaire.com/logo.png",
          "telephone": "+33123456789",
          "address": {
            "@type": "PostalAddress",
            "streetAddress": "123 Rue du Commerce",
            "addressLocality": "Paris",
            "postalCode": "75000",
            "addressCountry": "FR"
          },
          "openingHours": "Mo-Fr 09:00-18:00",
          "priceRange": "€€",
          "image": "https://www.destockage-alimentaire.com/entrepot.jpg",
          "sameAs": [
            "https://facebook.com/destockagealimentaire",
            "https://instagram.com/destockagealimentaire"
          ],
          "potentialAction": {
            "@type": "SearchAction",
            "target": "https://www.destockage-alimentaire.com/recherche?q={search_term_string}",
            "query-input": "required name=search_term_string"
          }
        }
        </script>
    {% block extra_js %}{% endblock %}
</body>
</html>